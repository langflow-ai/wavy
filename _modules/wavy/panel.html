<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>wavy.panel &mdash; Wavy 0.1.9 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<script type="text/javascript">
  window.onload = function() {
    document.body.innerHTML = document.body.innerHTML.replace(/ Module/g, '');
  }
</script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Wavy
          </a>
              <div class="version">
                0.1.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Using Wavy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../manual/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manual/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/quickstart2.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manual/tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/panel.html">wavy.panel Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/models.html">wavy.models Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/plot.html">wavy.plot Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Wavy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>wavy.panel</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for wavy.panel</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="c1"># import contextlib</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">figure</span>
<span class="kn">from</span> <span class="nn">pandas.core.groupby</span> <span class="kn">import</span> <span class="n">DataFrameGroupBy</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">wavy.plot</span> <span class="kn">import</span> <span class="n">plot</span>
<span class="kn">from</span> <span class="nn">wavy.validations</span> <span class="kn">import</span> <span class="n">_validate_sample_panel</span><span class="p">,</span> <span class="n">_validate_training_split</span>


<span class="c1"># Define column to y</span>
<div class="viewcode-block" id="create_panels"><a class="viewcode-back" href="../../api/wavy.panel.create_panels.html#wavy.panel.create_panels">[docs]</a><span class="k">def</span> <span class="nf">create_panels</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">lookback</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Panel</span><span class="p">,</span> <span class="n">Panel</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create panels from a dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (``pd.DataFrame``): Dataframe</span>
<span class="sd">        lookback (``int``): Lookback size</span>
<span class="sd">        horizon (``int``): Horizon size</span>
<span class="sd">        gap (``int``): Gap size</span>

<span class="sd">    Returns:</span>
<span class="sd">        ``tuple[Panel, Panel]``: Tuple of panels</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">indices</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>

    <span class="c1"># Sort by index</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">indices</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;DataFrame is being sorted!&quot;</span><span class="p">)</span>

    <span class="n">x_timesteps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">x_timesteps</span> <span class="o">-</span> <span class="n">lookback</span> <span class="o">-</span> <span class="n">horizon</span> <span class="o">-</span> <span class="n">gap</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not enough timesteps to build.&quot;</span><span class="p">)</span>

    <span class="n">end</span> <span class="o">=</span> <span class="n">x_timesteps</span> <span class="o">-</span> <span class="n">horizon</span> <span class="o">-</span> <span class="n">gap</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lookback</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

    <span class="n">xframes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="o">*</span> <span class="n">lookback</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">xindex</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="o">*</span> <span class="n">lookback</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="o">*</span> <span class="n">lookback</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">yframes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">yindex</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
        <span class="c1"># X</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span> <span class="p">:</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">xframes</span><span class="p">[</span>
            <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span><span class="p">)</span> <span class="o">*</span> <span class="n">lookback</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">lookback</span><span class="p">,</span> <span class="p">:</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">values</span>
        <span class="n">xindex</span><span class="p">[</span><span class="mi">0</span><span class="p">][(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span><span class="p">)</span> <span class="o">*</span> <span class="n">lookback</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">lookback</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">lookback</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">xindex</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span>
            <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span><span class="p">)</span> <span class="o">*</span> <span class="n">lookback</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">lookback</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Y</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">gap</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">gap</span> <span class="o">+</span> <span class="n">horizon</span><span class="p">]</span>
        <span class="n">yframes</span><span class="p">[</span>
            <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">,</span> <span class="p">:</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">values</span>
        <span class="n">yindex</span><span class="p">[</span><span class="mi">0</span><span class="p">][(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">horizon</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">yindex</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span>
            <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">lookback</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

    <span class="n">timesteps_name</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;timesteps&quot;</span>

    <span class="k">return</span> <span class="n">Panel</span><span class="p">(</span>
        <span class="n">xframes</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">xindex</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">timesteps_name</span><span class="p">]),</span>
    <span class="p">),</span> <span class="n">Panel</span><span class="p">(</span>
        <span class="n">yframes</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">yindex</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">timesteps_name</span><span class="p">]),</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="reset_ids"><a class="viewcode-back" href="../../api/wavy.panel.reset_ids.html#wavy.panel.reset_ids">[docs]</a><span class="k">def</span> <span class="nf">reset_ids</span><span class="p">(</span><span class="n">panels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Panel</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Panel</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reset ids of a panel.</span>

<span class="sd">    Args:</span>
<span class="sd">        panels (``list``): List of panels</span>
<span class="sd">        inplace (``bool``): Whether to reset ids inplace or not.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ``Panel``: Reset id of panel</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check if id in x and y are the same</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">panels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span> <span class="n">panel</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">panel</span> <span class="ow">in</span> <span class="n">panels</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Ids for panels are not the same. Try using match function first.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">panel</span><span class="o">.</span><span class="n">reset_ids</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span> <span class="k">for</span> <span class="n">panel</span> <span class="ow">in</span> <span class="n">panels</span><span class="p">]</span></div>


<div class="viewcode-block" id="dropna_match"><a class="viewcode-back" href="../../api/wavy.panel.dropna_match.html#wavy.panel.dropna_match">[docs]</a><span class="k">def</span> <span class="nf">dropna_match</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Drop frames with NaN in panels and match ids.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (``Panel``): Panel with x data</span>
<span class="sd">        y (``Panel``): Panel with y data</span>

<span class="sd">    Returns:</span>
<span class="sd">        ``Panel``: Panel with dropped frames and matched ids</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">x_t</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">dropna_frames</span><span class="p">()</span>
    <span class="n">y_t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">match_frames</span><span class="p">(</span><span class="n">x_t</span><span class="p">)</span>

    <span class="n">y_t</span> <span class="o">=</span> <span class="n">y_t</span><span class="o">.</span><span class="n">dropna_frames</span><span class="p">()</span>
    <span class="n">x_t</span> <span class="o">=</span> <span class="n">x_t</span><span class="o">.</span><span class="n">match_frames</span><span class="p">(</span><span class="n">y_t</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x_t</span><span class="p">,</span> <span class="n">y_t</span></div>


<div class="viewcode-block" id="concat_panels"><a class="viewcode-back" href="../../api/wavy.panel.concat_panels.html#wavy.panel.concat_panels">[docs]</a><span class="k">def</span> <span class="nf">concat_panels</span><span class="p">(</span>
    <span class="n">panels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Panel</span><span class="p">],</span> <span class="n">reset_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">sort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Concatenate panels.</span>

<span class="sd">    Args:</span>
<span class="sd">        panels (``list``): List of panels</span>
<span class="sd">        reset_ids (``bool``): Whether to reset ids</span>
<span class="sd">        sort (``bool``): Whether to sort by id</span>

<span class="sd">    Returns:</span>
<span class="sd">        ``Panel``: Concatenated panels</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get ids of all panels</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">panel</span><span class="o">.</span><span class="n">ids</span> <span class="k">for</span> <span class="n">panel</span> <span class="ow">in</span> <span class="n">panels</span><span class="p">]))</span>

    <span class="c1"># Check duplicated ids in list</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ids</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;There are duplicated ids in the list.&quot;</span><span class="p">)</span>

    <span class="n">panel</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">panels</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">sort</span><span class="p">:</span>
        <span class="n">panel</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">sort_panel</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">reset_ids</span><span class="p">:</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">reset_ids</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">panel</span></div>


<div class="viewcode-block" id="set_training_split"><a class="viewcode-back" href="../../api/wavy.panel.set_training_split.html#wavy.panel.set_training_split">[docs]</a><span class="k">def</span> <span class="nf">set_training_split</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Panel</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Panel</span><span class="p">,</span>
    <span class="n">train_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="n">val_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">test_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Splits panel in training, validation, and test.</span>

<span class="sd">    Args:</span>
<span class="sd">        train_size (``float`` or ``int``): Fraction of data to use for training.</span>
<span class="sd">        test_size (``float`` or ``int``): Fraction of data to use for testing.</span>
<span class="sd">        val_size (``float`` or ``int``): Fraction of data to use for validation.</span>

<span class="sd">    Example:</span>

<span class="sd">    &gt;&gt;&gt; x, y = set_training_split(x, y, train_size=0.8, val_size=0.2, test_size=0.1)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">x</span><span class="o">.</span><span class="n">set_training_split</span><span class="p">(</span><span class="n">train_size</span><span class="o">=</span><span class="n">train_size</span><span class="p">,</span> <span class="n">val_size</span><span class="o">=</span><span class="n">val_size</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">)</span>
    <span class="n">y</span><span class="o">.</span><span class="n">set_training_split</span><span class="p">(</span><span class="n">train_size</span><span class="o">=</span><span class="n">train_size</span><span class="p">,</span> <span class="n">val_size</span><span class="o">=</span><span class="n">val_size</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">)</span></div>


<span class="k">class</span> <span class="nc">_PanelSeries</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_constructor_expanddim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># def f(*args, **kw):</span>

        <span class="c1">#     df = Panel(*args, **kw)</span>

        <span class="c1">#     # Workaround to fix pandas bug</span>
        <span class="c1">#     if (df.index.nlevels &gt; 1 and self.index.nlevels &gt; 1) and len(</span>
        <span class="c1">#         df.index.levels</span>
        <span class="c1">#     ) &gt; len(self.index.levels):</span>
        <span class="c1">#         df = df.droplevel(0, axis=&quot;index&quot;)</span>

        <span class="c1">#     if df.num_frames == self.num_frames:</span>
        <span class="c1">#         self._copy_attrs(df)</span>

        <span class="c1">#     return df</span>

        <span class="c1"># return f</span>

        <span class="k">return</span> <span class="n">Panel</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_PanelSeries</span>


<div class="viewcode-block" id="Panel"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel">[docs]</a><span class="k">class</span> <span class="nc">Panel</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Panel class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Panel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Panel</span><span class="p">):</span>
            <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_copy_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">_attributes_</span> <span class="o">=</span> <span class="s2">&quot;train_size,test_size,val_size&quot;</span>

    <span class="k">def</span> <span class="nf">_copy_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributes_</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="n">df</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>

            <span class="c1"># with contextlib.suppress(Exception):</span>
            <span class="c1">#     index = [a for a in args[0].axes if isinstance(a, pd.MultiIndex)]</span>
            <span class="c1">#     if index and len(index[0]) == self.num_timesteps:</span>
            <span class="c1">#         return pd.DataFrame(*args, **kw)</span>

            <span class="n">df</span> <span class="o">=</span> <span class="n">Panel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

            <span class="c1"># Workaround to fix pandas bug</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span>
                <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span>
            <span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">):</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">num_frames</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_copy_attrs</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

            <span class="c1"># df.style.set_properties(**{&quot;background-color&quot;: &quot;black&quot;, &quot;color&quot;: &quot;green&quot;})</span>

            <span class="k">return</span> <span class="n">df</span>

        <span class="k">return</span> <span class="n">f</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_constructor_sliced</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_PanelSeries</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns the number of frames in the panel.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_panel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_timesteps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns the number of timesteps in the panel.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_panel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns the number of columns in the panel.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_panel</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">frames</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrameGroupBy</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns panel&#39;s frames.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timesteps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Int64Index</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns panel&#39;s timesteps.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Int64Index</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns panel&#39;s ids without duplicates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

    <span class="nd">@ids</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set panel&#39;s ids.</span>

<span class="sd">        Args:</span>
<span class="sd">            ids (``list``): List of ids.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_panel</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">timestep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">ids</span><span class="p">,</span> <span class="n">timestep</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">timestep</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>

<div class="viewcode-block" id="Panel.reset_ids"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.reset_ids">[docs]</a>    <span class="k">def</span> <span class="nf">reset_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset panel&#39;s ids.</span>

<span class="sd">        Args:</span>
<span class="sd">            inplace (``bool``): Whether to reset ids inplace.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span><span class="p">)</span>
        <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
            <span class="p">[</span><span class="n">new_ids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span>
            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">new_index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a tuple representing the dimensionality of the Panel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<div class="viewcode-block" id="Panel.row_panel"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.row_panel">[docs]</a>    <span class="k">def</span> <span class="nf">row_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the nth row of each frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (``list[int]`` or ``int``): Row index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;n must be -1 or between 0 and the number of timesteps&quot;</span><span class="p">)</span>

        <span class="n">new_panel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_copy_attrs</span><span class="p">(</span><span class="n">new_panel</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_panel</span></div>

<div class="viewcode-block" id="Panel.get_timesteps"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.get_timesteps">[docs]</a>    <span class="k">def</span> <span class="nf">get_timesteps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the first timestep of each frame in the panel.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (``list[int]`` or ``int``): Timestep to return.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        3D matrix with Panel value.</span>

<span class="sd">        Example:</span>

<span class="sd">        &gt;&gt;&gt; panel.values</span>
<span class="sd">        array([[[283.95999146, 284.13000488, 280.1499939 , 281.77999878],</span>
<span class="sd">                [282.58999634, 290.88000488, 276.73001099, 289.98001099]],</span>
<span class="sd">               [[282.58999634, 290.88000488, 276.73001099, 289.98001099],</span>
<span class="sd">                [285.54000854, 286.3500061 , 274.33999634, 277.3500061 ]],</span>
<span class="sd">               [[285.54000854, 286.3500061 , 274.33999634, 277.3500061 ],</span>
<span class="sd">                [274.80999756, 279.25      , 271.26998901, 274.73001099]],</span>
<span class="sd">               [[274.80999756, 279.25      , 271.26998901, 274.73001099],</span>
<span class="sd">                [270.05999756, 272.35998535, 263.32000732, 264.57998657]]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_panel</span><span class="p">)</span>

<div class="viewcode-block" id="Panel.flatten_panel"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.flatten_panel">[docs]</a>    <span class="k">def</span> <span class="nf">flatten_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Flatten the panel.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new_timesteps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span>
        <span class="p">)</span>
        <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">new_timesteps</span><span class="p">],</span>
            <span class="n">names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">panel</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">new_index</span><span class="p">)</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">)</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">panel</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_flat_index</span><span class="p">()]</span>

        <span class="n">panel</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>

        <span class="k">return</span> <span class="n">panel</span></div>

<div class="viewcode-block" id="Panel.drop_ids"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.drop_ids">[docs]</a>    <span class="k">def</span> <span class="nf">drop_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Drop frames by id.</span>

<span class="sd">        Args:</span>
<span class="sd">            ids (``list[int]`` or ``int``): List of ids to drop.</span>
<span class="sd">            inplace (``bool``): Whether to drop ids inplace.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel``: Panel with frames dropped.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="Panel.findna_frames"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.findna_frames">[docs]</a>    <span class="k">def</span> <span class="nf">findna_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Int64Index</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find NaN values index.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``List``: List with index of NaN frames.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">na</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">na</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">na</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
            <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">Int64Index</span><span class="p">([],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Panel.dropna_frames"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.dropna_frames">[docs]</a>    <span class="k">def</span> <span class="nf">dropna_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Drop frames with missing values from the panel.</span>

<span class="sd">        Args:</span>
<span class="sd">            inplace (``bool``): Whether to drop frames inplace.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel``: Panel with frames dropped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop_ids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">findna_frames</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="Panel.match_frames"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.match_frames">[docs]</a>    <span class="k">def</span> <span class="nf">match_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Panel</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Match panel with other panel.</span>

<span class="sd">        This function will match the ids and id order of self based on the ids of other.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (``Panel``): Panel to match with.</span>
<span class="sd">            inplace (``bool``): Whether to match inplace.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel``: Result of match function.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">other_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
        <span class="n">self_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">other_ids</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">self_ids</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;There are elements in other that are not in self.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop_ids</span><span class="p">(</span><span class="n">self_ids</span> <span class="o">-</span> <span class="n">other_ids</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="n">ids</span><span class="p">]</span></div>

<div class="viewcode-block" id="Panel.set_training_split"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.set_training_split">[docs]</a>    <span class="k">def</span> <span class="nf">set_training_split</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">train_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
        <span class="n">val_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
        <span class="n">test_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Splits Panel into training, validation, and test.</span>

<span class="sd">        Args:</span>
<span class="sd">            train_size (``float`` or ``int``): Fraction of data to use for training.</span>
<span class="sd">            test_size (``float`` or ``int``): Fraction of data to use for testing.</span>
<span class="sd">            val_size (``float`` or ``int``): Fraction of data to use for validation.</span>

<span class="sd">        Example:</span>

<span class="sd">        &gt;&gt;&gt; panel.set_training_split(train_size=0.8, val_size=0.2, test_size=0.1)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">n_train</span><span class="p">,</span> <span class="n">n_val</span><span class="p">,</span> <span class="n">n_test</span> <span class="o">=</span> <span class="n">_validate_training_split</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span><span class="p">,</span>
            <span class="n">train_size</span><span class="o">=</span><span class="n">train_size</span><span class="p">,</span>
            <span class="n">val_size</span><span class="o">=</span><span class="n">val_size</span><span class="p">,</span>
            <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">train_size</span> <span class="o">=</span> <span class="n">n_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_size</span> <span class="o">=</span> <span class="n">n_val</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_size</span> <span class="o">=</span> <span class="n">n_test</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="o">+</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Panel.to_dataframe"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.to_dataframe">[docs]</a>    <span class="k">def</span> <span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert panel to dataframe.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``pd.DataFrame``: Dataframe with panel values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the Panel with the training set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel``: Panel with the training set.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_size</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@train</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the training set.</span>

<span class="sd">        Args:</span>
<span class="sd">            value (``Panel``): Panel with the training set.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No training set was set.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">val</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the Panel with the validation set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel``: Panel with the validation set.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="p">[</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="p">:</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="p">)</span>
                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_size</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

    <span class="nd">@val</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the validation set.</span>

<span class="sd">        Args:</span>
<span class="sd">            value (``Panel``): Panel with the validation set.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No validation set was set.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="p">:</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the Panel with the testing set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel``: Panel with the testing set.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">test_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="p">:]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_size</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@test</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the testing set.</span>

<span class="sd">        Args:</span>
<span class="sd">            value (``Panel``): Panel with the testing set.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No testing set was set.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">test_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">values</span>

<div class="viewcode-block" id="Panel.head_panel"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.head_panel">[docs]</a>    <span class="k">def</span> <span class="nf">head_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the first n frames of the panel.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (``int``): Number of frames to return.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel``: Result of head function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[:</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_panel</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span></div>

<div class="viewcode-block" id="Panel.tail_panel"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.tail_panel">[docs]</a>    <span class="k">def</span> <span class="nf">tail_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the last n frames of the panel.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (``int``): Number of frames to return.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel``: Result of tail function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_panel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:]</span></div>

<div class="viewcode-block" id="Panel.sort_panel"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.sort_panel">[docs]</a>    <span class="k">def</span> <span class="nf">sort_panel</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ascending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">kind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;quicksort&quot;</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sort panel by ids.</span>

<span class="sd">        Args:</span>
<span class="sd">            ascending (``bool`` or list-like of ``bools``, default True): Sort ascending vs. descending. When the index is a MultiIndex the sort direction can be controlled for each level individually.</span>
<span class="sd">            inplace (``bool``, default False): If True, perform operation in-place.</span>
<span class="sd">            kind ({&#39;quicksort&#39;, &#39;mergesort&#39;, &#39;heapsort&#39;, &#39;stable&#39;}, default &#39;quicksort&#39;): Choice of sorting algorithm. See also numpy.sort() for more information. mergesort and stable are the only stable algorithms. For DataFrames, this option is only applied when sorting on a single column or label.</span>
<span class="sd">            key (callable, optional): If not None, apply the key function to the index values before sorting. This is similar to the key argument in the builtin sorted() function, with the notable difference that this key function should be vectorized. It should expect an Index and return an Index of the same shape. For MultiIndex inputs, the key is applied per level.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel`` or ``None``: The original DataFrame sorted by the labels or None if `inplace=True`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">,</span>
            <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">,</span>
            <span class="n">sort_remaining</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Panel.sample_panel"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.sample_panel">[docs]</a>    <span class="k">def</span> <span class="nf">sample_panel</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">how</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spaced&quot;</span><span class="p">,</span>
        <span class="n">reset_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sample panel returning a subset of frames.</span>

<span class="sd">        Args:</span>
<span class="sd">            samples (``int`` or ``float``): Number or percentage of samples to return.</span>
<span class="sd">            how (``str``): Sampling method, &#39;spaced&#39; or &#39;random&#39;</span>
<span class="sd">            reset_ids (``bool``): If True, reset the index of the sampled panel.</span>
<span class="sd">            seed (``int``): Random seed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel``: Result of sample function.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_size</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;train_size&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span>
        <span class="n">val_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_size</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;val_size&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">test_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_size</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;test_size&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="n">train_samples</span><span class="p">,</span> <span class="n">val_samples</span><span class="p">,</span> <span class="n">test_samples</span> <span class="o">=</span> <span class="n">_validate_sample_panel</span><span class="p">(</span>
            <span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">,</span>
            <span class="n">train_size</span><span class="o">=</span><span class="n">train_size</span><span class="p">,</span>
            <span class="n">val_size</span><span class="o">=</span><span class="n">val_size</span><span class="p">,</span>
            <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="s2">&quot;random&quot;</span><span class="p">:</span>
            <span class="c1"># Set seed</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;train_size&quot;</span><span class="p">):</span>
                <span class="n">train_ids</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span> <span class="n">train_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">val_ids</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span> <span class="n">val_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">test_ids</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span> <span class="n">test_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">train_ids</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">,</span> <span class="n">train_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">val_ids</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">test_ids</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">elif</span> <span class="n">how</span> <span class="o">==</span> <span class="s2">&quot;spaced&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;train_size&quot;</span><span class="p">):</span>
                <span class="n">train_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">train_samples</span><span class="p">,</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                    <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">val_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">val_samples</span><span class="p">,</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                    <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">test_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">test_samples</span><span class="p">,</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                    <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">train_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">train_samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="n">val_ids</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">test_ids</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">new_panel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="o">*</span><span class="n">train_ids</span><span class="p">,</span> <span class="o">*</span><span class="n">val_ids</span><span class="p">,</span> <span class="o">*</span><span class="n">test_ids</span><span class="p">]]</span>

        <span class="c1"># Reset ids</span>
        <span class="k">if</span> <span class="n">reset_ids</span><span class="p">:</span>
            <span class="n">new_panel</span><span class="o">.</span><span class="n">reset_ids</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Set new train, val, test sizes</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;train_size&quot;</span><span class="p">):</span>
            <span class="n">new_panel</span><span class="o">.</span><span class="n">train_size</span> <span class="o">=</span> <span class="n">train_samples</span>
            <span class="n">new_panel</span><span class="o">.</span><span class="n">val_size</span> <span class="o">=</span> <span class="n">val_samples</span>
            <span class="n">new_panel</span><span class="o">.</span><span class="n">test_size</span> <span class="o">=</span> <span class="n">test_samples</span>

        <span class="c1"># # TODO inplace not working</span>
        <span class="c1"># if inplace:</span>
        <span class="c1">#     self = new_panel</span>
        <span class="c1">#     return None</span>

        <span class="k">return</span> <span class="n">new_panel</span></div>

<div class="viewcode-block" id="Panel.shuffle_panel"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.shuffle_panel">[docs]</a>    <span class="k">def</span> <span class="nf">shuffle_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reset_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Panel</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shuffle the panel.</span>

<span class="sd">        Args:</span>
<span class="sd">            seed (``int``): Random seed.</span>
<span class="sd">            reset_ids (``bool``): If True, reset the index of the shuffled panel.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``Panel``: Result of shuffle function.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># warnings.warn(&quot;Shuffling the panel can result in data leakage.&quot;)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;train_size&quot;</span><span class="p">):</span>
            <span class="n">train_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
            <span class="n">val_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
            <span class="n">test_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">train_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
            <span class="n">val_ids</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">test_ids</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">train_ids</span><span class="p">)</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">val_ids</span><span class="p">)</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">test_ids</span><span class="p">)</span>

        <span class="n">new_panel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="o">*</span><span class="n">train_ids</span><span class="p">,</span> <span class="o">*</span><span class="n">val_ids</span><span class="p">,</span> <span class="o">*</span><span class="n">test_ids</span><span class="p">]]</span>

        <span class="c1"># Reset ids</span>
        <span class="k">if</span> <span class="n">reset_ids</span><span class="p">:</span>
            <span class="n">new_panel</span><span class="o">.</span><span class="n">reset_ids</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># # TODO inplace not working</span>
        <span class="c1"># if inplace:</span>
        <span class="c1">#     self = new_panel</span>
        <span class="c1">#     return None</span>

        <span class="k">return</span> <span class="n">new_panel</span></div>

<div class="viewcode-block" id="Panel.plot"><a class="viewcode-back" href="../../api/wavy.panel.Panel.html#wavy.panel.Panel.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">add_annotation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="nb">max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10_000</span><span class="p">,</span>
        <span class="n">use_timestep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plot</span><span class="o">.</span><span class="n">PanelFigure</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the panel.</span>

<span class="sd">        Args:</span>
<span class="sd">            add_annotation (``bool``): If True, plot the training, validation, and test annotation.</span>
<span class="sd">            max (``int``): Maximum number of samples to plot.</span>
<span class="sd">            use_timestep (``bool``): If True, plot the timestep instead of the sample index.</span>
<span class="sd">            **kwargs: Additional arguments to pass to the plot function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ``plot``: Result of plot function.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">panel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_panel</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">max</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">plot</span><span class="p">(</span>
                <span class="n">panel</span><span class="o">.</span><span class="n">sample_panel</span><span class="p">(</span><span class="nb">max</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;spaced&quot;</span><span class="p">),</span>
                <span class="n">use_timestep</span><span class="o">=</span><span class="n">use_timestep</span><span class="p">,</span>
                <span class="n">add_annotation</span><span class="o">=</span><span class="n">add_annotation</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">plot</span><span class="p">(</span>
            <span class="n">panel</span><span class="p">,</span> <span class="n">use_timestep</span><span class="o">=</span><span class="n">use_timestep</span><span class="p">,</span> <span class="n">add_annotation</span><span class="o">=</span><span class="n">add_annotation</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Logspace.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>